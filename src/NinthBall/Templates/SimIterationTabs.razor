@using System;
@using NinthBall.Core;

<!-- TabSet - Details on chosen percentiles -->
<div>

    <ul class="nav" role="tablist">
        <li class="nav-item">
            <a class="nav-link disabled" aria-disabled="true">Details: </a>
        </li>
        @foreach (var p in Percentiles.Items)
        {
            var pctlId = PercentileId(p.Pctl);
            var pctlCaption = p.PctlName;

            var isActive = p.Pctl == Percentiles.Target ? "active" : "";

            <li class="nav-item">
                <a class="nav-link @isActive" data-bs-toggle="tab" href="#@(pctlId)">@pctlCaption</a>
            </li>
        }
    </ul>

    <div class="tab-content">
        @foreach (var p in Percentiles.Items)
        {
            var iter = Model.Percentile(p.Pctl);
            var pctlId = PercentileId(p.Pctl);
            var caption = $"{p.PctlName} Percentile";
            var isActive = p.Pctl == Percentiles.Target ? "active" : "";
            <div class="tab-pane @isActive" id="@(pctlId)">
                <SimIterationDetails Id="@pctlId" Caption="@caption" Iteration=iter />
            </div>
        }
    </div>
</div>

@code
{
    [Parameter] public SimResult Model { get; set; } = null!;

    static string PercentileId(double pctl) => $"{pctl * 100:00}";

}