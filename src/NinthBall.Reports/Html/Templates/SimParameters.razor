@using System;
@using NinthBall.Core;

<div class="section">

    @{
        var I = SimResult.Iterations.First().ByYear.Span[0].Jan;

        var startPreTax   = $"{I.PreTax.Amount:C0}";
        var startPostTax  = $"{I.PostTax.Amount:C0}";
        var startAlloc    = I.PreTax.Allocation;
        int numYears      = SimResult.SimParams.NoOfYears;
        int numIterations = SimResult.Iterations.Count;
    }

    <h4 class="mt-3">
        @startPreTax pre-tax + @startPostTax post-tax | @($"{startAlloc:P0}") stocks | @(numYears) years | @($"{numIterations:#,0}") iterations
    </h4>

    <div class="accordion accordion-flush" id="accAssumptions">
        <div class="accordion-item">
            <h2 class="accordion-header" id="accAssumptionsTitle">
                <button class="accordion-button collapsed py-2" type="button" data-bs-toggle="collapse" data-bs-target="#accAssumptionsBlock" aria-expanded="false" aria-controls="accAssumptionsBlock">
                    Expand to view strategies and assumptions:
                </button>
            </h2>
            <div id="accAssumptionsBlock" class="accordion-collapse collapse" aria-labelledby="accAssumptionsTitle" data-bs-parent="#accAssumptions">
                <div class="accordion-body">
                    <ul>
                        @foreach (var strategy in SimResult.Strategies)
                        {
                            <li>@strategy</li>
                        }
                    </ul>
                </div>
            </div>
        </div>
    </div>

</div>

@code
{
    [CascadingParameter]
    public SimResult SimResult { get; set; } = null!;
}